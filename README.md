# stock-telegram-bot
# Telegram Stock Forecast Bot

Учебный Telegram-бот для анализа и прогнозирования цен акций на основе временных рядов.  
Бот загружает котировки с Yahoo Finance, обучает несколько моделей (ML, ARIMA, LSTM), выбирает лучшую по метрике RMSE, строит прогноз на 30 дней, ищет дни для условной покупки/продажи и оценивает потенциальную прибыль.

## Функциональность

- Ввод тикера (например, `AAPL`, `MSFT`) и суммы условной инвестиции.
- Загрузка исторических данных за последние 2 года через `yfinance`.
- Обучение трёх моделей разных типов:
  - Классическая ML-модель (Random Forest с лаговыми признаками).
  - Статистическая модель (ARIMA).
  - Нейросеть (LSTM для временных рядов).
- Автоматический выбор лучшей модели по RMSE.
- Прогноз цен на ближайшие 30 дней.
- График с историей и прогнозом (PNG).
- Поиск локальных минимумов/максимумов и формирование рекомендаций (BUY/SELL).
- Расчёт условной итоговой стоимости и прибыли при следовании стратегиям.
- Логирование каждого запроса пользователя в CSV-файл.

## Структура проекта

project/
bot.py # Основной файл бота
requirements.txt # Список зависимостей
README.md # Описание проекта
logs.csv # Логи (создаётся автоматически при первом запуске)

text

## Требования

- Python 3.9+ (рекомендуется)
- Аккаунт в Telegram
- Созданный бот и токен от BotFather

## Как получить токен Telegram-бота

1. Откройте Telegram и найдите пользователя `@BotFather`.
2. Нажмите **Start**.
3. Отправьте команду `/newbot`.
4. Укажите имя бота (произвольное).
5. Укажите username бота (должен заканчиваться на `bot`, например `my_stock_forecast_bot`).
6. Сохраните выданный токен вида `123456:ABC-DEF...` — он нужен для запуска бота.

При необходимости вы можете пересоздать токен через команды BotFather `/revoke` / `/token`.

## Установка (локально или на VM с Ubuntu)

1. Склонировать репозиторий или скопировать файлы:

git clone <URL_ВАШЕГО_РЕПОЗИТОРИЯ>.git
cd <имя_папки_проекта>

text

2. Создать виртуальное окружение и установить зависимости:

python3 -m venv .venv
source .venv/bin/activate
python -m pip install -U pip
python -m pip install -r requirements.txt

text

3. Задать токен бота:


export BOT_TOKEN="123456:ABC-DEF..."
export LOG_PATH="logs.csv" # необязательно, по умолчанию logs.csv
python bot.py

text

## Запуск бота

source .venv/bin/activate
python bot.py

text

После запуска:
- Откройте ваш бот в Telegram.
- Отправьте `/start`.
- Введите тикер (например, `AAPL`).
- Введите сумму условной инвестиции (например, `10000`).

Бот ответит:
- графиком (PNG) с историей и прогнозом,
- краткой сводкой: лучшая модель, RMSE, изменение цены,
- списком дат BUY/SELL и оценкой условной прибыли.

## Замечания

- Бот носит исключительно учебный характер и **не является** финансовым советом.
- Для LSTM может потребоваться достаточно оперативной памяти и времени обучения. На слабых VM возможны долгие ответы.
- При ошибках загрузки данных (неверный тикер, проблемы с сетью) бот отправит сообщение с описанием ошибки.